from matplotlib import pyplot as plt
from argparse import ArgumentParser
import numpy as np
import json


def main():

    parser = ArgumentParser()

    parser.add_argument('client_filename',help='json file generated by the client application to be visualized.')
    parser.add_argument('prometheus_filename',help='json file downloaded from prometheus to be visualized')
    parser.add_argument('-g', action="store_true")

    args = parser.parse_args()

    with open(args.client_filename) as f:
        client_data = json.load(f)

    with open(args.prometheus_filename) as f:
        prometheus_data = json.load(f)

    c_data, client_start_time = client_data['data'], client_data['start_time']
    p_data, prometheus_start_time = prometheus_data['data'], prometheus_data['start_time']

    assert client_start_time == prometheus_start_time, "The two files must have the same start time"

    c_data = np.array(c_data)
    p_data = np.array(p_data)


    plt.plot(p_data[:,0], p_data[:,-1]); plt.show()


if __name__ == "__main__":
    main()